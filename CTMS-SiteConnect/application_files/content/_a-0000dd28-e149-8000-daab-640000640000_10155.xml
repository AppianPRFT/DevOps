<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<contentHaul xmlns:a="http://www.appian.com/ae/types/2009">
    <versionUuid>_a-0000df6a-d82f-8000-9ba2-011c48011c48_112440</versionUuid>
    <rule>
        <name>CTMS_Document_EditSiteDocumet</name>
        <uuid>_a-0000dd28-e149-8000-daab-640000640000_10155</uuid>
        <description>Site Document upload for CTMS</description>
        <parentUuid>_a-0000dcd5-e7b4-8000-daab-640000640000_6355</parentUuid>
        <visibility>
            <advertise>false</advertise>
            <hierarchy>true</hierarchy>
            <indexable>true</indexable>
            <quota>false</quota>
            <searchable>true</searchable>
            <system>false</system>
            <unlogged>false</unlogged>
        </visibility>
        <definition>load(
  local!document: /* if(rule!CTMS_checkNull(ri!documentIdentifier),{},*/#"_a-0000dd28-aefc-8000-daab-640000640000_10091"(
    ID: ri!documentIdentifier[1]
  ),
  local!UploadedDocument,
  with(
    #"SYSTEM_SYSRULES_formLayout_v1"(
      contents: {
        #"SYSTEM_SYSRULES_sectionLayout_v1"(
          contents:{
            #"SYSTEM_SYSRULES_milestoneField"(
              steps : {"Create Request","Waiting for Approval","Approved"},
              active : wherecontains({"Create Request","Waiting for Approval","Approved"},ri!Status)
              
            )
          }
        ),
        #"SYSTEM_SYSRULES_sectionLayout_v1"(
          label:"Upload Document",
          contents: {
            #"SYSTEM_SYSRULES_textField"(
              label: "Document Identifier",
              labelPosition: "ADJACENT",
              value: index(local!document,"documentIdentifier","N/A"),
              saveInto: local!document.documentIdentifier,
              readOnly: true
            ),

            #"SYSTEM_SYSRULES_dateField"(
              label: "Expiration Date",
              labelPosition: "ADJACENT",
              value: index(local!document,"expirationDate"," "),
              saveInto: local!document.expirationDate,
              readOnly: true,
              validations:if(or(not(#"_a-0000dcfa-ab37-8000-daab-640000640000_7168"(ri!UploadedDocument)),                        
                              index(local!document,"expirationDate"," ")&gt;today()),{},"Date Expired")
            ),
          
         
            #"SYSTEM_SYSRULES_textField"(
              label: "Document Type",
              labelPosition: "ADJACENT",
              value: index(local!document,"documentType"," "),
              saveInto: local!document.documentType,
              readOnly: true
            ),
            
          }
        
        ),
        #"SYSTEM_SYSRULES_sectionLayout_v1"(
          contents: {
            #"SYSTEM_SYSRULES_paragraphField"(
              label: "Description",
              labelPosition: "ADJACENT",
              value: index(local!document,"documentDescription"," "),
              saveInto: local!document.documentDescription,
              readOnly: true
            ),
            if(
              #"_a-0000dcfa-ab37-8000-daab-640000640000_7168"(
                Index(local!document,"documentID"," ")
              ),{},
              #"SYSTEM_SYSRULES_linkField"(
                label: "Attached",
                labelPosition: "ADJACENT",
                instructions:"Click on the link to download",
                links: {
                  #"SYSTEM_SYSRULES_documentDownloadLink"(
                    label: if(#"_a-0000dcfa-ab37-8000-daab-640000640000_7168"(local!document.documentId),{}, 
                              document(local!document.documentId,"name")),
                    document: todocument(
                      index(local!document,"documentId"," ")
                    )
                  )
                }
              )),
            #"SYSTEM_SYSRULES_fileUploadField_v1"(
                label: "Upload New Document",
                labelPosition: "ADJACENT",
                target: #"_a-0000ddcb-815e-8000-daab-640000640000_18425",
                value: ri!UploadedDocument,
                required:if(local!document.expirationDate &lt; today(),true,false),
                saveInto: {
                  ri!UploadedDocument,
                  a!save(ri!Site_Document.documentId,tointeger(ri!UploadedDocument)),
                  a!save(ri!Site_Document.documentDescription,ri!requesterComment),
                  a!save(ri!Site_Document.expirationDate,ri!expirationDate)
                }
              ),
          if(#"_a-0000dcfa-ab37-8000-daab-640000640000_7168"(ri!UploadedDocument),{},
            #"SYSTEM_SYSRULES_dateField"(
              label: "New Document Expiration Date",
              labelPosition: "ADJACENT",
              value: ri!expirationDate,
              saveInto: ri!expirationDate, 
              readOnly: false,
              required: true,
              validations: if(ri!expirationDate&lt;today(),"Please enter future date",{})
            )),
          
          
        {
          if(isnull(ri!approverComment),{},
            #"SYSTEM_SYSRULES_paragraphField"(
              label: "Approver Comment",
              required:true,
              labelPosition: "ADJACENT",
              value: ri!approverComment,
              saveInto: ri!approverComment,
              readOnly: true
            ))
            },
            
            
            #"SYSTEM_SYSRULES_paragraphField"(
              label: "Comment",
              required:true,
              instructions:"Write a note for the approver.",
              labelPosition: "ADJACENT",
              value: ri!requesterComment,
              saveInto: ri!requesterComment,
              readOnly: false
            )
          }
        )
      },
      buttons: {
        #"SYSTEM_SYSRULES_ButtonLayout"(
          primaryButtons: {
            #"SYSTEM_SYSRULES_ButtonWidgetSubmit"(
              label: #"_a-0000ddcb-815e-8000-daab-640000640000_18394",
              style: "PRIMARY",
              value: #"_a-0000ddcb-815e-8000-daab-640000640000_18394",
              saveInto: ri!btnAction
            )
          },
          secondaryButtons: {
            #"SYSTEM_SYSRULES_ButtonWidgetSubmit"(
              label: #"_a-0000ddcb-815e-8000-daab-640000640000_18391",
              value: #"_a-0000ddcb-815e-8000-daab-640000640000_18391",
              saveInto: {
                ri!btnAction,
              },
              skipValidation: true
            )
          }
        )
        
      }
    )
  )
)</definition>
        <namedTypedValue>
            <name>documentIdentifier</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>btnAction</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>isReadOnly</name>
            <type>
                <name>boolean</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>UploadedDocument</name>
            <type>
                <name>CollaborationDocument</name>
                <namespace>http://www.appian.com/ae/types/2009</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>requesterComment</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>approverComment</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <namedTypedValue>
            <name>expirationDate</name>
            <type>
                <name>date</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>Site_Document</name>
            <type>
                <name>CTMS_SiteDocument</name>
                <namespace>urn:com:appian:types:CTMS</namespace>
            </type>
        </namedTypedValue>
        <namedTypedValue>
            <name>Status</name>
            <type>
                <name>string</name>
                <namespace>http://www.w3.org/2001/XMLSchema</namespace>
            </type>
            <value/>
        </namedTypedValue>
        <metadataExpr></metadataExpr>
        <preferredEditor>interface</preferredEditor>
        <offlineEnabled>false</offlineEnabled>
    </rule>
    <roleMap public="true">
        <role inherit="true" allowForAll="false" name="readers">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="authors">
            <users/>
            <groups/>
        </role>
        <role inherit="true" allowForAll="false" name="administrators">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyReaders">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAuthors">
            <users/>
            <groups/>
        </role>
        <role inherit="false" allowForAll="false" name="denyAdministrators">
            <users/>
            <groups/>
        </role>
    </roleMap>
    <typedValue>
        <type>
            <name>RuleTestConfig?list</name>
            <namespace>http://www.appian.com/ae/types/2009</namespace>
        </type>
        <value>
            <el>
                <a:name/>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>documentIdentifier</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>btnAction</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:boolean">true</a:value>
                    <a:nameRef>isReadOnly</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="a:CollaborationDocument"/>
                    <a:nameRef>UploadedDocument</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>requesterComment</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>approverComment</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="xsd:date"/>
                    <a:nameRef>expirationDate</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:n1="urn:com:appian:types:CTMS" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true" xsi:type="n1:CTMS_SiteDocument"/>
                    <a:nameRef>Site_Document</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:ruleInputTestConfigs>
                    <a:value xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="xsd:string"/>
                    <a:nameRef>Status</a:nameRef>
                    <a:id/>
                </a:ruleInputTestConfigs>
                <a:assertions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:nil="true"/>
            </el>
        </value>
    </typedValue>
    <history>
        <historyInfo versionUuid="_a-0000df6a-d82f-8000-9ba2-011c48011c48_112440"/>
    </history>
</contentHaul>
